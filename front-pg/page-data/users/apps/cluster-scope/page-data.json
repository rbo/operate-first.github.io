{"componentChunkName":"component---src-templates-markdown-js","path":"/users/apps/cluster-scope/","result":{"data":{"site":{"siteMetadata":{"title":"Operate First"}},"markdownRemark":{"id":"d71d0d1b-bbcf-5013-8dbb-d1f2c5ac0cd4","html":"<h1 id=\"cluster-management-application-organization\" style=\"position:relative;\"><a href=\"#cluster-management-application-organization\" aria-label=\"cluster management application organization permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Cluster management application organization</h1>\n<p>In this directory we declaratively store cluster resources and other privileged resources that are not accessible by project admins.</p>\n<h2 id=\"application-folder-structure\" style=\"position:relative;\"><a href=\"#application-folder-structure\" aria-label=\"application folder structure permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Application folder structure</h2>\n<p>This directory adheres to the following structure:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">cluster-scope\n.\n├── base\n│   └── &lt;resource_api_group&gt;\n│       └── &lt;resource_kind_plural&gt;\n│           └── &lt;resource_metadata_name&gt;\n│               ├── kustomization.yaml\n│               └── &lt;resource_kind_singular&gt;.yaml\n├── components\n│   ├── &lt;descriptive_component_name&gt;\n│   └── kustomization.yaml\n└── overlays\n    └── &lt;env&gt;\n        └── &lt;cluster_name&gt;\n            ├── &lt;additional_overlay_files_or_folders&gt;\n            └── kustomization.yaml</code></pre></div>\n<p>The directories and files in this structure fulfill the following purpose:</p>\n<h4 id=\"base\" style=\"position:relative;\"><a href=\"#base\" aria-label=\"base permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>base/</h4>\n<ul class=\"pf-c-list\">\n<li><code class=\"language-text\">&lt;resource_api_group&gt;</code> : All resources are stored under their respective API Groups e.g. an OCP <code class=\"language-text\">Group</code> would be organized under <code class=\"language-text\">user.openshift.io</code></li>\n<li><code class=\"language-text\">&lt;resource_kind_plural&gt;</code> : Each resource kind managed by this application has a folder using the resource name in plural format, e.g. <code class=\"language-text\">clusterroles</code> or <code class=\"language-text\">namespaces</code>.</li>\n<li><code class=\"language-text\">&lt;resource_metadata_name&gt;</code> : The name of the resource deployed at cluster scope. It must match the resource <code class=\"language-text\">.metadata.name</code> in <code class=\"language-text\">&lt;resource_kind_singular&gt;.yaml</code>. Since this resource is deployed at the cluster scope, its name has to be unique.</li>\n<li><code class=\"language-text\">kustomization.yaml</code> : Kustomization file including a single resource, which is a sibling file within the folder. Can pull in <code class=\"language-text\">components</code> for additional bootstrapping.</li>\n<li><code class=\"language-text\">&lt;resource_kind_singular&gt;.yaml</code> : <strong>Single</strong> resource manifest with a <code class=\"language-text\">.spec</code> that can be deployed to all the clusters.</li>\n</ul>\n<h4 id=\"components\" style=\"position:relative;\"><a href=\"#components\" aria-label=\"components permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>components/</h4>\n<p>Bootstrapping components pulled into <code class=\"language-text\">base</code> (this is different to the standard usage in Kustomize!).</p>\n<ul class=\"pf-c-list\">\n<li><code class=\"language-text\">&lt;descriptive_component_name&gt;</code> : Folder describing intention of the component. Can be a grouping folder for additional nested components (by the subject), e.g. <code class=\"language-text\">project-admin-rolebinding</code> component is expected to define project admin <code class=\"language-text\">RoleBinding</code> and within this folder there are nested components for each specific user group.</li>\n<li><code class=\"language-text\">kustomization.yaml</code> : Kustomization file including a all the resources required for this component. All resources are sibling files to this file.</li>\n</ul>\n<h4 id=\"overlays\" style=\"position:relative;\"><a href=\"#overlays\" aria-label=\"overlays permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>overlays/</h4>\n<p>Contains an overlay per managed environment/cluster. Only overlaying manifests from <code class=\"language-text\">base</code> is supported.</p>\n<ul class=\"pf-c-list\">\n<li><code class=\"language-text\">&lt;env&gt;</code> : The environment to which a cluster belongs.</li>\n<li><code class=\"language-text\">&lt;cluster_name&gt;</code> : A folder per each managed cluster defining. Path to this folder is specified in the <code class=\"language-text\">Application</code> resource for cluster management application.</li>\n<li><code class=\"language-text\">kustomization.yaml</code> : Cluster specific Kustomization file with a list of all resources pulled from base. This resource list is ordered alphabetically so it matches the order as it appears in file tree.</li>\n<li><code class=\"language-text\">additional_overlay_files_or_folders</code> : Additional overlayed files, folders, secret generators etc.</li>\n</ul>\n<p>Note: Exceptions are made for custom resource quotas, and other namespace scoped resources that are similarly coupled to a namespace, but are under the purview of the cluster administrators. These are generally stored alongside namespaces i.e. <code class=\"language-text\">base/core/namespaces/&lt;namespace_name&gt;/</code>.</p>\n<h2 id=\"creating-new-resources\" style=\"position:relative;\"><a href=\"#creating-new-resources\" aria-label=\"creating new resources permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Creating new resources</h2>\n<ol class=\"pf-c-list\">\n<li>Create the resource in <code class=\"language-text\">base</code> folder.</li>\n<li>Pull the resource in desired <code class=\"language-text\">overlay</code>s.</li>\n</ol>\n<blockquote>\n<p>For adding a custom resource quotas follow instructions as outlined <a href=\"../docs/cluster-scope/add_resource_quotas.md\">here</a></p>\n</blockquote>\n<h2 id=\"updating-existing-resource-in-base\" style=\"position:relative;\"><a href=\"#updating-existing-resource-in-base\" aria-label=\"updating existing resource in base permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Updating existing resource in base</h2>\n<p>If you desire to update a resource in <code class=\"language-text\">base</code>, please consider if your changes are not overlay/cluster specific. If it is, rather update the resource in your cluster overlay.</p>\n<p>If you think this change should be applied to all the clusters, please proceed to update it in the <code class=\"language-text\">base</code>. Verify what clusters are using this resource in their overlays and request an approver for all the effected clusters to review your PR.</p>\n<h2 id=\"updating-existing-resource-in-components\" style=\"position:relative;\"><a href=\"#updating-existing-resource-in-components\" aria-label=\"updating existing resource in components permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Updating existing resource in components</h2>\n<p>Updating a resource in a <code class=\"language-text\">component</code> requires you to verify all the usages of the component and what overlays are transitively affected. Please request review accordingly. This is similar to making changes to <code class=\"language-text\">base</code> resources.</p>","fields":{"srcLink":"https://github.com/operate-first/apps/blob/master/cluster-scope/README.md"},"frontmatter":{"title":"","description":null,"extraClasses":null}}},"pageContext":{"id":"d71d0d1b-bbcf-5013-8dbb-d1f2c5ac0cd4"}},"staticQueryHashes":["117426894","3000541721","3606484676","533861647"]}