{"componentChunkName":"component---src-templates-jupyter-notebook-js","path":"/data-science/ocp-ci-analysis/notebooks/data-sources/TestGrid/metrics/get_raw_data.ipynb","result":{"data":{"site":{"siteMetadata":{"title":"Operate First"}},"jupyterNotebook":{"id":"1f233016-5203-5843-8287-86c9d6085ad0 >>> JupyterNotebook","html":"<div class=\"notebook-render\"><div class=\"sc-ifAKCX zMCZx\"><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><h1>Fetch test grid data</h1>\n<ul>\n<li>In this notebook, we fetch relevant data from <a href=\"https://testgrid.k8s.io\">https://testgrid.k8s.io</a> and save on Ceph for further analysis.</li>\n<li>This is supposed to be run in automation as a part of kubeflow pipeline.</li>\n</ul></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[1]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\">## Import libraries</span>\n<span class=\"token\" style=\"color:#0000ff\">import</span> datetime\n<span class=\"token\" style=\"color:#0000ff\">import</span> os\n<span class=\"token\" style=\"color:#0000ff\">import</span> json\n<span class=\"token\" style=\"color:#0000ff\">from</span> dotenv <span class=\"token\" style=\"color:#0000ff\">import</span> load_dotenv<span class=\"token\" style=\"color:#393A34\">,</span> find_dotenv\n<span class=\"token\" style=\"color:#0000ff\">import</span> requests\n<span class=\"token\" style=\"color:#0000ff\">from</span> bs4 <span class=\"token\" style=\"color:#0000ff\">import</span> BeautifulSoup\n<span class=\"token\" style=\"color:#0000ff\">from</span> ipynb<span class=\"token\" style=\"color:#393A34\">.</span>fs<span class=\"token\" style=\"color:#393A34\">.</span>defs<span class=\"token\" style=\"color:#393A34\">.</span>metric_template <span class=\"token\" style=\"color:#0000ff\">import</span> CephCommunication\n\nload_dotenv<span class=\"token\" style=\"color:#393A34\">(</span>find_dotenv<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><pre><code><span>True</span></code></pre></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[2]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\">## Specify variables</span>\n\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># Specify the path for input grid data</span>\nINPUT_DATA_PATH <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#393A34\">(</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;https://testgrid.k8s.io/redhat-openshift-informing?id=dashboard-group-bar&quot;</span>\n<span class=\"token\" style=\"color:#393A34\">)</span>\n\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># Specify the path for output raw data</span>\nOUTPUT_DATA_PATH <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#A31515\">&quot;../../../../data/raw&quot;</span>\n\n<span class=\"token\" style=\"color:#008000;font-style:italic\">## CEPH Bucket variables</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">## Create a .env file on your local with the correct configs</span>\ns3_endpoint_url <span class=\"token\" style=\"color:#393A34\">=</span> os<span class=\"token\" style=\"color:#393A34\">.</span>getenv<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;S3_ENDPOINT&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span>\ns3_access_key <span class=\"token\" style=\"color:#393A34\">=</span> os<span class=\"token\" style=\"color:#393A34\">.</span>getenv<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;S3_ACCESS_KEY&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span>\ns3_secret_key <span class=\"token\" style=\"color:#393A34\">=</span> os<span class=\"token\" style=\"color:#393A34\">.</span>getenv<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;S3_SECRET_KEY&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span>\ns3_bucket <span class=\"token\" style=\"color:#393A34\">=</span> os<span class=\"token\" style=\"color:#393A34\">.</span>getenv<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;S3_BUCKET&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span>\ns3_input_data_path <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#A31515\">&quot;raw_data&quot;</span>\n\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># Specify whether or not we are running this as a notebook or part of an automation pipeline.</span>\nAUTOMATION <span class=\"token\" style=\"color:#393A34\">=</span> os<span class=\"token\" style=\"color:#393A34\">.</span>getenv<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;IN_AUTOMATION&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[3]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\">## Connect to the url and fetch dashboard names</span>\nresponse <span class=\"token\" style=\"color:#393A34\">=</span> requests<span class=\"token\" style=\"color:#393A34\">.</span>get<span class=\"token\" style=\"color:#393A34\">(</span>INPUT_DATA_PATH<span class=\"token\" style=\"color:#393A34\">)</span>\nhtml <span class=\"token\" style=\"color:#393A34\">=</span> BeautifulSoup<span class=\"token\" style=\"color:#393A34\">(</span>response<span class=\"token\" style=\"color:#393A34\">.</span>content<span class=\"token\" style=\"color:#393A34\">)</span>\ntestgrid_script <span class=\"token\" style=\"color:#393A34\">=</span> html<span class=\"token\" style=\"color:#393A34\">.</span>findAll<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;script&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">3</span><span class=\"token\" style=\"color:#393A34\">]</span>\ntestgrid_script <span class=\"token\" style=\"color:#393A34\">=</span> testgrid_script<span class=\"token\" style=\"color:#393A34\">.</span>text<span class=\"token\" style=\"color:#393A34\">.</span>split<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">5</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>split<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;,&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span>\ndashboard_names <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#393A34\">[</span>x<span class=\"token\" style=\"color:#393A34\">.</span>split<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;:&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span> <span class=\"token\" style=\"color:#0000ff\">for</span> x <span class=\"token\" style=\"color:#0000ff\">in</span> testgrid_script <span class=\"token\" style=\"color:#0000ff\">if</span> <span class=\"token\" style=\"color:#A31515\">&quot;name&quot;</span> <span class=\"token\" style=\"color:#0000ff\">in</span> x<span class=\"token\" style=\"color:#393A34\">]</span>\ndashboard_names</code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><pre><code><span>[&#x27;&quot;redhat-assisted-installer&quot;&#x27;,\n &#x27;&quot;redhat-openshift-informing&quot;&#x27;,\n &#x27;&quot;redhat-openshift-ocp-release-4.1-blocking&quot;&#x27;,\n &#x27;&quot;redhat-openshift-ocp-release-4.1-informing&quot;&#x27;,\n &#x27;&quot;redhat-openshift-ocp-release-4.2-blocking&quot;&#x27;,\n &#x27;&quot;redhat-openshift-ocp-release-4.2-informing&quot;&#x27;,\n &#x27;&quot;redhat-openshift-ocp-release-4.3-blocking&quot;&#x27;,\n &#x27;&quot;redhat-openshift-ocp-release-4.3-broken&quot;&#x27;,\n &#x27;&quot;redhat-openshift-ocp-release-4.3-informing&quot;&#x27;,\n &#x27;&quot;redhat-openshift-ocp-release-4.4-blocking&quot;&#x27;,\n &#x27;&quot;redhat-openshift-ocp-release-4.4-broken&quot;&#x27;,\n &#x27;&quot;redhat-openshift-ocp-release-4.4-informing&quot;&#x27;,\n &#x27;&quot;redhat-openshift-ocp-release-4.5-blocking&quot;&#x27;,\n &#x27;&quot;redhat-openshift-ocp-release-4.5-broken&quot;&#x27;,\n &#x27;&quot;redhat-openshift-ocp-release-4.5-informing&quot;&#x27;,\n &#x27;&quot;redhat-openshift-ocp-release-4.6-blocking&quot;&#x27;,\n &#x27;&quot;redhat-openshift-ocp-release-4.6-broken&quot;&#x27;,\n &#x27;&quot;redhat-openshift-ocp-release-4.6-informing&quot;&#x27;,\n &#x27;&quot;redhat-openshift-ocp-release-4.7-blocking&quot;&#x27;,\n &#x27;&quot;redhat-openshift-ocp-release-4.7-broken&quot;&#x27;,\n &#x27;&quot;redhat-openshift-ocp-release-4.7-informing&quot;&#x27;,\n &#x27;&quot;redhat-openshift-ocp-release-4.8-blocking&quot;&#x27;,\n &#x27;&quot;redhat-openshift-ocp-release-4.8-informing&quot;&#x27;,\n &#x27;&quot;redhat-openshift-ocp-release-4.9-blocking&quot;&#x27;,\n &#x27;&quot;redhat-openshift-ocp-release-4.9-informing&quot;&#x27;,\n &#x27;&quot;redhat-openshift-okd-release-4.3-informing&quot;&#x27;,\n &#x27;&quot;redhat-openshift-okd-release-4.4-informing&quot;&#x27;,\n &#x27;&quot;redhat-openshift-okd-release-4.5-blocking&quot;&#x27;,\n &#x27;&quot;redhat-openshift-okd-release-4.5-informing&quot;&#x27;,\n &#x27;&quot;redhat-openshift-okd-release-4.6-blocking&quot;&#x27;,\n &#x27;&quot;redhat-openshift-okd-release-4.6-informing&quot;&#x27;,\n &#x27;&quot;redhat-openshift-okd-release-4.7-blocking&quot;&#x27;,\n &#x27;&quot;redhat-openshift-okd-release-4.7-informing&quot;&#x27;,\n &#x27;&quot;redhat-openshift-okd-release-4.8-blocking&quot;&#x27;,\n &#x27;&quot;redhat-openshift-okd-release-4.8-informing&quot;&#x27;,\n &#x27;&quot;redhat-openshift-okd-release-4.9-informing&quot;&#x27;,\n &#x27;&quot;redhat-openshift-presubmit-master-gcp&quot;&#x27;,\n &#x27;&quot;redhat-osd&quot;&#x27;,\n &#x27;&quot;redhat-single-node&quot;&#x27;]</span></code></pre></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[4]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\">## Download the dashboard data</span>\ndownload <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#36acaa\">True</span>\n<span class=\"token\" style=\"color:#0000ff\">if</span> download<span class=\"token\" style=\"color:#393A34\">:</span>\n    data_set <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#393A34\">}</span>\n\n    <span class=\"token\" style=\"color:#0000ff\">for</span> dashboard <span class=\"token\" style=\"color:#0000ff\">in</span> dashboard_names<span class=\"token\" style=\"color:#393A34\">:</span>\n        response_1 <span class=\"token\" style=\"color:#393A34\">=</span> requests<span class=\"token\" style=\"color:#393A34\">.</span>get<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token string-interpolation\"><span class=\"token\" style=\"color:#A31515\">f&quot;https://testgrid.k8s.io/</span><span class=\"token interpolation\"><span class=\"token\" style=\"color:#393A34\">{</span>dashboard<span class=\"token\" style=\"color:#393A34\">}</span></span><span class=\"token\" style=\"color:#A31515\">/summary&quot;</span></span><span class=\"token\" style=\"color:#393A34\">)</span>\n        jobs <span class=\"token\" style=\"color:#393A34\">=</span> response_1<span class=\"token\" style=\"color:#393A34\">.</span>json<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>keys<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span>\n        dashboard_jobs <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#393A34\">}</span>\n\n        <span class=\"token\" style=\"color:#0000ff\">for</span> job <span class=\"token\" style=\"color:#0000ff\">in</span> jobs<span class=\"token\" style=\"color:#393A34\">:</span>\n            response_2 <span class=\"token\" style=\"color:#393A34\">=</span> requests<span class=\"token\" style=\"color:#393A34\">.</span>get<span class=\"token\" style=\"color:#393A34\">(</span>\n                <span class=\"token string-interpolation\"><span class=\"token\" style=\"color:#A31515\">f&quot;https://testgrid.k8s.io/</span><span class=\"token interpolation\"><span class=\"token\" style=\"color:#393A34\">{</span>dashboard<span class=\"token\" style=\"color:#393A34\">}</span></span><span class=\"token\" style=\"color:#A31515\">/table?&amp;show-stale-tests=&amp;tab=</span><span class=\"token interpolation\"><span class=\"token\" style=\"color:#393A34\">{</span>job<span class=\"token\" style=\"color:#393A34\">}</span></span><span class=\"token\" style=\"color:#A31515\">&amp;graph-metrics=test-duration-minutes&quot;</span></span>  <span class=\"token\" style=\"color:#008000;font-style:italic\"># noqa</span>\n            <span class=\"token\" style=\"color:#393A34\">)</span>\n            <span class=\"token\" style=\"color:#0000ff\">if</span> response_2<span class=\"token\" style=\"color:#393A34\">.</span>status_code <span class=\"token\" style=\"color:#393A34\">!=</span> <span class=\"token\" style=\"color:#36acaa\">200</span><span class=\"token\" style=\"color:#393A34\">:</span>\n                <span class=\"token\" style=\"color:#0000ff\">continue</span>\n\n            <span class=\"token\" style=\"color:#0000ff\">if</span> <span class=\"token\" style=\"color:#A31515\">&quot;tests&quot;</span> <span class=\"token\" style=\"color:#0000ff\">in</span> response_2<span class=\"token\" style=\"color:#393A34\">.</span>json<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span>\n                grid <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">]</span>\n                <span class=\"token\" style=\"color:#0000ff\">for</span> x <span class=\"token\" style=\"color:#0000ff\">in</span> response_2<span class=\"token\" style=\"color:#393A34\">.</span>json<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&quot;tests&quot;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">:</span>\n                    test <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&quot;name&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> x<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&quot;name&quot;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&quot;statuses&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> x<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&quot;statuses&quot;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">}</span>\n                    <span class=\"token\" style=\"color:#0000ff\">if</span> <span class=\"token\" style=\"color:#A31515\">&quot;graphs&quot;</span> <span class=\"token\" style=\"color:#0000ff\">in</span> x<span class=\"token\" style=\"color:#393A34\">.</span>keys<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span>\n                        test<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&quot;graphs&quot;</span><span class=\"token\" style=\"color:#393A34\">]</span> <span class=\"token\" style=\"color:#393A34\">=</span> x<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&quot;graphs&quot;</span><span class=\"token\" style=\"color:#393A34\">]</span>\n                    <span class=\"token\" style=\"color:#0000ff\">else</span><span class=\"token\" style=\"color:#393A34\">:</span>\n                        test<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&quot;graphs&quot;</span><span class=\"token\" style=\"color:#393A34\">]</span> <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#36acaa\">None</span>\n                    grid<span class=\"token\" style=\"color:#393A34\">.</span>append<span class=\"token\" style=\"color:#393A34\">(</span>test<span class=\"token\" style=\"color:#393A34\">)</span>\n\n                time_stamps <span class=\"token\" style=\"color:#393A34\">=</span> response_2<span class=\"token\" style=\"color:#393A34\">.</span>json<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&quot;timestamps&quot;</span><span class=\"token\" style=\"color:#393A34\">]</span>\n\n                dashboard_jobs<span class=\"token\" style=\"color:#393A34\">[</span>job<span class=\"token\" style=\"color:#393A34\">]</span> <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&quot;grid&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> grid<span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&quot;timestamps&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> time_stamps<span class=\"token\" style=\"color:#393A34\">}</span>\n\n        data_set<span class=\"token\" style=\"color:#393A34\">[</span>dashboard<span class=\"token\" style=\"color:#393A34\">]</span> <span class=\"token\" style=\"color:#393A34\">=</span> dashboard_jobs\n        <span class=\"token\" style=\"color:#0000ff\">print</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token string-interpolation\"><span class=\"token\" style=\"color:#A31515\">f&quot;</span><span class=\"token interpolation\"><span class=\"token\" style=\"color:#393A34\">{</span>dashboard<span class=\"token\" style=\"color:#393A34\">}</span></span><span class=\"token\" style=\"color:#A31515\"> downloaded &quot;</span></span><span class=\"token\" style=\"color:#393A34\">)</span>\n<span class=\"token\" style=\"color:#0000ff\">else</span><span class=\"token\" style=\"color:#393A34\">:</span>\n    <span class=\"token\" style=\"color:#0000ff\">print</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;Not Downloading&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-stdout\"><span>&quot;redhat-assisted-installer&quot; downloaded \n&quot;redhat-openshift-informing&quot; downloaded \n&quot;redhat-openshift-ocp-release-4.1-blocking&quot; downloaded \n&quot;redhat-openshift-ocp-release-4.1-informing&quot; downloaded \n&quot;redhat-openshift-ocp-release-4.2-blocking&quot; downloaded \n&quot;redhat-openshift-ocp-release-4.2-informing&quot; downloaded \n&quot;redhat-openshift-ocp-release-4.3-blocking&quot; downloaded \n&quot;redhat-openshift-ocp-release-4.3-broken&quot; downloaded \n&quot;redhat-openshift-ocp-release-4.3-informing&quot; downloaded \n&quot;redhat-openshift-ocp-release-4.4-blocking&quot; downloaded \n&quot;redhat-openshift-ocp-release-4.4-broken&quot; downloaded \n&quot;redhat-openshift-ocp-release-4.4-informing&quot; downloaded \n&quot;redhat-openshift-ocp-release-4.5-blocking&quot; downloaded \n&quot;redhat-openshift-ocp-release-4.5-broken&quot; downloaded \n&quot;redhat-openshift-ocp-release-4.5-informing&quot; downloaded \n&quot;redhat-openshift-ocp-release-4.6-blocking&quot; downloaded \n&quot;redhat-openshift-ocp-release-4.6-broken&quot; downloaded \n&quot;redhat-openshift-ocp-release-4.6-informing&quot; downloaded \n&quot;redhat-openshift-ocp-release-4.7-blocking&quot; downloaded \n&quot;redhat-openshift-ocp-release-4.7-broken&quot; downloaded \n&quot;redhat-openshift-ocp-release-4.7-informing&quot; downloaded \n&quot;redhat-openshift-ocp-release-4.8-blocking&quot; downloaded \n&quot;redhat-openshift-ocp-release-4.8-informing&quot; downloaded \n&quot;redhat-openshift-ocp-release-4.9-blocking&quot; downloaded \n&quot;redhat-openshift-ocp-release-4.9-informing&quot; downloaded \n&quot;redhat-openshift-okd-release-4.3-informing&quot; downloaded \n&quot;redhat-openshift-okd-release-4.4-informing&quot; downloaded \n&quot;redhat-openshift-okd-release-4.5-blocking&quot; downloaded \n&quot;redhat-openshift-okd-release-4.5-informing&quot; downloaded \n&quot;redhat-openshift-okd-release-4.6-blocking&quot; downloaded \n&quot;redhat-openshift-okd-release-4.6-informing&quot; downloaded \n&quot;redhat-openshift-okd-release-4.7-blocking&quot; downloaded \n&quot;redhat-openshift-okd-release-4.7-informing&quot; downloaded \n&quot;redhat-openshift-okd-release-4.8-blocking&quot; downloaded \n&quot;redhat-openshift-okd-release-4.8-informing&quot; downloaded \n&quot;redhat-openshift-okd-release-4.9-informing&quot; downloaded \n&quot;redhat-openshift-presubmit-master-gcp&quot; downloaded \n&quot;redhat-osd&quot; downloaded \n&quot;redhat-single-node&quot; downloaded \n</span></code></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[5]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\">## Set filename</span>\ndate <span class=\"token\" style=\"color:#393A34\">=</span> datetime<span class=\"token\" style=\"color:#393A34\">.</span>datetime<span class=\"token\" style=\"color:#393A34\">.</span>today<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span>\nfilename <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token string-interpolation\"><span class=\"token\" style=\"color:#A31515\">f&quot;testgrid_</span><span class=\"token interpolation\"><span class=\"token\" style=\"color:#393A34\">{</span>date<span class=\"token\" style=\"color:#393A34\">.</span>day<span class=\"token\" style=\"color:#393A34\">}</span></span><span class=\"token interpolation\"><span class=\"token\" style=\"color:#393A34\">{</span>date<span class=\"token\" style=\"color:#393A34\">.</span>month<span class=\"token\" style=\"color:#393A34\">}</span></span><span class=\"token\" style=\"color:#A31515\">.json&quot;</span></span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[6]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\">timestamp <span class=\"token\" style=\"color:#393A34\">=</span> datetime<span class=\"token\" style=\"color:#393A34\">.</span>datetime<span class=\"token\" style=\"color:#393A34\">.</span>now<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span>\n\n<span class=\"token\" style=\"color:#0000ff\">if</span> AUTOMATION<span class=\"token\" style=\"color:#393A34\">:</span>\n    <span class=\"token\" style=\"color:#008000;font-style:italic\">## Connect to Ceph</span>\n    cc <span class=\"token\" style=\"color:#393A34\">=</span> CephCommunication<span class=\"token\" style=\"color:#393A34\">(</span>s3_endpoint_url<span class=\"token\" style=\"color:#393A34\">,</span> s3_access_key<span class=\"token\" style=\"color:#393A34\">,</span> s3_secret_key<span class=\"token\" style=\"color:#393A34\">,</span> s3_bucket<span class=\"token\" style=\"color:#393A34\">)</span>\n\n    <span class=\"token\" style=\"color:#008000;font-style:italic\">## Put data on ceph</span>\n    s3_obj <span class=\"token\" style=\"color:#393A34\">=</span> cc<span class=\"token\" style=\"color:#393A34\">.</span>s3_resource<span class=\"token\" style=\"color:#393A34\">.</span>Object<span class=\"token\" style=\"color:#393A34\">(</span>s3_bucket<span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token string-interpolation\"><span class=\"token\" style=\"color:#A31515\">f&quot;</span><span class=\"token interpolation\"><span class=\"token\" style=\"color:#393A34\">{</span>s3_input_data_path<span class=\"token\" style=\"color:#393A34\">}</span></span><span class=\"token\" style=\"color:#A31515\">/</span><span class=\"token interpolation\"><span class=\"token\" style=\"color:#393A34\">{</span>filename<span class=\"token\" style=\"color:#393A34\">}</span></span><span class=\"token\" style=\"color:#A31515\">&quot;</span></span><span class=\"token\" style=\"color:#393A34\">)</span>\n    status <span class=\"token\" style=\"color:#393A34\">=</span> s3_obj<span class=\"token\" style=\"color:#393A34\">.</span>put<span class=\"token\" style=\"color:#393A34\">(</span>Body<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token builtin\">bytes</span><span class=\"token\" style=\"color:#393A34\">(</span>json<span class=\"token\" style=\"color:#393A34\">.</span>dumps<span class=\"token\" style=\"color:#393A34\">(</span>data_set<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>encode<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;UTF-8&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span>\n\n    <span class=\"token\" style=\"color:#008000;font-style:italic\">## Print Status</span>\n    <span class=\"token\" style=\"color:#0000ff\">print</span><span class=\"token\" style=\"color:#393A34\">(</span>status<span class=\"token\" style=\"color:#393A34\">)</span>\n\n<span class=\"token\" style=\"color:#0000ff\">else</span><span class=\"token\" style=\"color:#393A34\">:</span>\n    file_path <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token string-interpolation\"><span class=\"token\" style=\"color:#A31515\">f&quot;</span><span class=\"token interpolation\"><span class=\"token\" style=\"color:#393A34\">{</span>OUTPUT_DATA_PATH<span class=\"token\" style=\"color:#393A34\">}</span></span><span class=\"token\" style=\"color:#A31515\">/</span><span class=\"token interpolation\"><span class=\"token\" style=\"color:#393A34\">{</span>filename<span class=\"token\" style=\"color:#393A34\">}</span></span><span class=\"token\" style=\"color:#A31515\">&quot;</span></span>\n    <span class=\"token\" style=\"color:#0000ff\">with</span> <span class=\"token builtin\">open</span><span class=\"token\" style=\"color:#393A34\">(</span>file_path<span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&quot;w&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#0000ff\">as</span> outfile<span class=\"token\" style=\"color:#393A34\">:</span>\n        json<span class=\"token\" style=\"color:#393A34\">.</span>dump<span class=\"token\" style=\"color:#393A34\">(</span>data_set<span class=\"token\" style=\"color:#393A34\">,</span> outfile<span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-stdout\"><span>{&#x27;ResponseMetadata&#x27;: {&#x27;RequestId&#x27;: &#x27;knht0bi2-f6z6ty-115m&#x27;, &#x27;HostId&#x27;: &#x27;knht0bi2-f6z6ty-115m&#x27;, &#x27;HTTPStatusCode&#x27;: 200, &#x27;HTTPHeaders&#x27;: {&#x27;x-amz-request-id&#x27;: &#x27;knht0bi2-f6z6ty-115m&#x27;, &#x27;x-amz-id-2&#x27;: &#x27;knht0bi2-f6z6ty-115m&#x27;, &#x27;access-control-allow-origin&#x27;: &#x27;*&#x27;, &#x27;access-control-allow-credentials&#x27;: &#x27;true&#x27;, &#x27;access-control-allow-methods&#x27;: &#x27;GET,POST,PUT,DELETE,OPTIONS&#x27;, &#x27;access-control-allow-headers&#x27;: &#x27;Content-Type,Content-MD5,Authorization,X-Amz-User-Agent,X-Amz-Date,ETag,X-Amz-Content-Sha256&#x27;, &#x27;access-control-expose-headers&#x27;: &#x27;ETag,X-Amz-Version-Id&#x27;, &#x27;etag&#x27;: &#x27;&quot;7b7ff1bfdfe25e30abe9f490e53180c0&quot;&#x27;, &#x27;date&#x27;: &#x27;Wed, 14 Apr 2021 18:45:34 GMT&#x27;, &#x27;connection&#x27;: &#x27;keep-alive&#x27;, &#x27;content-length&#x27;: &#x27;0&#x27;}, &#x27;RetryAttempts&#x27;: 0}, &#x27;ETag&#x27;: &#x27;&quot;7b7ff1bfdfe25e30abe9f490e53180c0&quot;&#x27;}\n</span></code></div></div></div></div></div>","fields":{"srcLink":"https://github.com/aicoe-aiops/ocp-ci-analysis/blob/master/notebooks/data-sources/TestGrid/metrics/get_raw_data.ipynb"}}},"pageContext":{"id":"1f233016-5203-5843-8287-86c9d6085ad0 >>> JupyterNotebook"}},"staticQueryHashes":["117426894","3000541721","3606484676","533861647"]}